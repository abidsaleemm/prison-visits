<% content_for :header, t('.title') %>

<div class="Grid">
  <div class="Grid-2-3">
    <p>
      <%= t('.intro_html',
            prison_name: @visit.prison_name) %>
    </p>
  </div>
</div>
<div class="Grid">
  <div class="Grid-2-3">
    <dl>
      <dt><%= t('.your_visit') %></dt>
      <dd>
        <ul class="unstyled-list visit-times">
          <li>
            <strong><%= format_slot_for_public(@visit.slot_granted) %></strong>
          </li>
        </ul>
      </dd>
    </dl>
  </div>
</div>
<div class="Grid">
  <div class="Grid-1-3">
    <dl>
      <dt>Allowed visitors</dt>
      <dd>
        <ul class="unstyled-list visit-times">
          <% @visit.allowed_visitors.each do |visitor| %>
            <li><strong><%= visitor.anonymized_name %></strong></li>
          <% end %>
        </ul>
      </dd>
    </dl>
  </div>
  <div class="Grid-1-3">
    <% if @visit.rejected_visitors.any? %>
      <dl>
        <dt>Rejected visitors</dt>
        <dd>
        <ul class="unstyled-list visit-times">
          <% @visit.rejected_visitors.each do |visitor| %>
            <li><strong><%= visitor.anonymized_name %></strong></li>
          <% end %>
        </ul>
        </dd>
      </dl>
  <% end %>
  </div>
</div>
<div class="Grid">
  <div class="Grid-1-3">
    <dl>
      <dt><%= t('.location') %></dt>
      <dd class="h3">
        <strong>
          <%= @visit.prison_name %>
          <br/>
          <%= add_line_breaks(@visit.prison_address) %>
          <br/>
          <%= @visit.prison_postcode %>
        </strong>
      </dd>
    </dl>
    <p class="map-link">
      <%= link_to(t('.google_maps'),
                  link_directory.google_maps(@visit.prison_postcode)) %>
    </p>
  </div>
  <div class="Grid-1-3">
    <dl>
      <dt><%= t('.phone_no') %></dt>
      <dd><strong><%= @visit.prison_phone_no %></strong></dd>
      <br/>
      <dt><%= t('.email') %></dt>
      <dd><strong><%= mail_to(@visit.prison_email_address) %></strong></dd>
    </dl>
  </div>
  <div class="Grid-1-3">
    <p class="visible--js-enabled">
      <%= link_to(t('.print_page'), '#', class: 'print-link') %>
    </p>
  </div>
</div>
<div class="Grid" id="info">
  <div class="Grid-1-3">
    <nav>
      <h2>
        <%= t('.instructions_nav_title', name: @visit.prison_name) %>
      </h2>

      <ul>
        <li>
          <a href="#info-what-to-bring"
            ><%= t('shared.visit_info.what_to_bring_title') %></a>
        </li>
        <li>
          <a href="#info-bringing-child"
            ><%= t('shared.visit_info.bringing_child_title') %></a>
        </li>
        <li>
          <a href="#info-what-to-expect"
            ><%= t('shared.visit_info.what_to_expect_title') %></a>
        </li>
        <li>
          <a href="#info-what-not-to-bring"
            ><%= t('shared.visit_info.what_not_to_bring_title') %></a>
        </li>
        <li>
          <a href="#cancel-visit" ><%= t('.cancel_title') %></a>
        </li>
        <li>
          <a href="#info-check-spam"><%= t('.check_spam_title') %></a>
        </li>
      </ul>
    </nav>
  </div>
  <div class="Grid-2-3">

    <%= render('shared/visit_info', visit: @visit) %>

    <div id='cancel-visit'>
      <h2><%= t('.cancel_title') %></h2>

      <p><%= t('.cancel_intro') %></p>

      <%= form_tag(cancellations_path, html: { class: 'js-SubmitOnce' }) do %>
        <%= hidden_field_tag(:id, @visit.id) %>

        <div class="group">
          <label class="block-label">
            <%= check_box_tag(:confirmed) %>
            <%= t('.cancel_confirm') %>
          </label>
        </div>

        <div class='actions'>
          <div class="primary-actions">
            <%= submit_tag(t('.cancel_cta'), class: 'button button-primary') %>
          </div>
        </div>
      <% end %>
    </div>

    <h2 id="info-check-spam">
      <%= t('.check_spam_title') %>
    </h2>

    <%= t('.check_spam_body_html',
            phone_no: @visit.prison_phone_no,
            prison_email_address: @visit.prison_email_address) %>
    <div class="footnote">
      <p><%= link_to(t('.rate_service_html'), link_directory.rate_service) %></p>
    </div>
  </div>
</div>
